<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<html>
<head>
<title>ZBBFI0010_TOP</title>
</head>
<body bgcolor="#FFFFE0">
<font size="3" face = "Arial" color="#000000"><b>Code listing for: ZBBFI0010_TOP</b></font>
<br>
<font size="3" face = "Arial" color="#000000"><b>Description:  Include ZBBFI0010_TOP</b></font>
<hr>
<pre width="100">
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
<font color ="#0000FF">*& Include          ZBBFI0010_TOP</font>
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>

" SELECTION SCREEN APPLICATION TOOLBAR BUTTON 생성.
TABLES: SSCRFIELDS.

" 1.엑셀 파일의 필드와 일치하는 Structure 정의.
TYPES : BEGIN OF TS_DATA,
          ACODE   TYPE ZTBFI0010-ACODE, "공통 필드
          RTYPE   TYPE ZTBFI0010-RTYPE, "마스터 필드
          GCODE   TYPE ZTBFI0010-GCODE,
          CATCODE TYPE ZTBFI0010-CATCODE,
          ANAME   TYPE ZTBFI0011-ANAME, "텍스트 필드
        END OF TS_DATA.

DATA: GT_DATA TYPE TABLE OF TS_DATA, "최종 출력 테이블
      GS_DATA TYPE TS_DATA.          "WA

DATA : GT_MASTER TYPE TABLE OF ZTBFI0010,
       GS_MASTER LIKE LINE OF GT_MASTER,
       GT_TEXT TYPE TABLE OF ZTBFI0011,
       GS_TEXT LIKE LINE OF GT_TEXT.


" 2. 데이터 선언
<font color ="#0000FF">*DATA: GT_MASTER TYPE TABLE OF TS_MASTER, "마스터 테이블용 Internal table</font>
<font color ="#0000FF">*      GS_MASTER LIKE LINE OF GT_MASTER,        "마스터 테이블용 WA</font>
<font color ="#0000FF">*      GT_TEXT   TYPE TABLE OF TS_TEXT,    "TEXT TABLE용 Internal table</font>
<font color ="#0000FF">*      GS_TEXT   LIKE LINE OF  GT_TEXT,          "TEXT TABLE용 WA</font>
<font color ="#0000FF">*      LT_EXCEL_ROW  TYPE TS_EXCEL,              "엑셀 한 행 데이터</font>
<font color ="#0000FF">*      LV_FILE_NAME  TYPE STRING,                "업로드할 파일 경로</font>
<font color ="#0000FF">*      LV_FILE_TABLE TYPE FILETABLE,             "파일 다일로그에서 선택된 파일 목록</font>
<font color ="#0000FF">*      LV_RESULT     TYPE I.                     "파일 선택 결과</font>
DATA: GT_EXCEL TYPE TABLE OF ALSMEX_TABLINE, "엑셀 데이터 담을 테이블
      GS_EXCEL LIKE LINE OF GT_EXCEL.

" 3. ALV 변수 선언
<font color ="#0000FF">*TYPES : BEGIN OF TS_OUTTAB,</font>
<font color ="#0000FF">*          ACODE   TYPE ZTBFI0010-ACODE,</font>
<font color ="#0000FF">*          COMCODE TYPE ZTBFI0010-COMCODE,</font>
<font color ="#0000FF">*          RTYPE   TYPE ZTBFI0010-RTYPE,</font>
<font color ="#0000FF">*          GCODE   TYPE ZTBFI0010-GCODE,</font>
<font color ="#0000FF">*          CATCODE TYPE ZTBFI0010-CATCODE,</font>
<font color ="#0000FF">*          ANAME   TYPE ZTBFI0011-ANAME,</font>
<font color ="#0000FF">*        END OF TS_OUTTAB.</font>
<font color ="#0000FF">*</font>
<font color ="#0000FF">*DATA: GT_OUTTAB TYPE TABLE OF TS_OUTTAB,  " ALV에 표시할 최종 테이블</font>
<font color ="#0000FF">*      GS_OUTTAB TYPE TS_OUTTAB.</font>

DATA: OK_CODE TYPE SY-UCOMM.

DATA: GS_LAYOUT TYPE LVC_S_LAYO,
      GT_SORT   TYPE LVC_T_SORT,
      GS_SORT   TYPE LVC_S_SORT,
      GT_FCAT   TYPE LVC_T_FCAT,
      GS_FCAT   TYPE LVC_S_FCAT,
      GO_CONT   TYPE REF TO CL_GUI_CUSTOM_CONTAINER,
<font color ="#0000FF">*      GO_DOCK TYPE REF TO CL_GUI_DOCKING_CONTAINER,</font>
      GO_ALV    TYPE REF TO CL_GUI_ALV_GRID.

<font color ="#0000FF">*PARAMETERS PA_FILE TYPE LOCALFILE.</font>
</pre>
<hr>
<font size="2" face = "Sans Serif">Extracted by Direct Download Enterprise version 1.3.1 - E.G.Mellodew. 1998-2005 UK. Sap Release 754
</font>
</body>
</html>
