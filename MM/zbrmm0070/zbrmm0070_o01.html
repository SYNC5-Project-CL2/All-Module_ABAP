<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<html>
<head>
<title>ZBRMM0070_O01</title>
</head>
<body bgcolor="#FFFFE0">
<font size="3" face = "Arial" color="#000000"><b>Code listing for: ZBRMM0070_O01</b></font>
<br>
<font size="3" face = "Arial" color="#000000"><b>Description:  Include ZBRMM0070_O01</b></font>
<hr>
<pre width="100">
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
<font color ="#0000FF">*& Include          ZBRMM0070_O01</font>
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
<font color ="#0000FF">*& Module STATUS_0100 OUTPUT</font>
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
<font color ="#0000FF">*&</font>
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
MODULE status_0100 OUTPUT.
  SET PF-STATUS 'S100'.
  SET TITLEBAR 'T100'.
ENDMODULE.
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
<font color ="#0000FF">*& Module CLEAR_OK_CODE OUTPUT</font>
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
<font color ="#0000FF">*&</font>
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
MODULE clear_ok_code OUTPUT.
  CLEAR ok_code.
ENDMODULE.
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
<font color ="#0000FF">*& Module GET_ALV1_DATA OUTPUT</font>
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
<font color ="#0000FF">*&</font>
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
MODULE get_alv1_data OUTPUT.

  PERFORM select_po.


ENDMODULE.
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
<font color ="#0000FF">*& Module SET_ALV1 OUTPUT</font>
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
<font color ="#0000FF">*&</font>
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
MODULE set_alv1 OUTPUT.

  IF go_cont1 IS INITIAL.
    CREATE OBJECT go_cont1
      EXPORTING
        container_name              = 'AREA1'
      EXCEPTIONS
        cntl_error                  = 1
        cntl_system_error           = 2
        create_error                = 3
        lifetime_error              = 4
        lifetime_dynpro_dynpro_link = 5
        OTHERS                      = 6.
    IF sy-subrc &lt;&gt; 0.
    ENDIF.

    CREATE OBJECT go_alv1
      EXPORTING
        i_parent          = go_cont1
      EXCEPTIONS
        error_cntl_create = 1
        error_cntl_init   = 2
        error_cntl_link   = 3
        error_dp_create   = 4
        OTHERS            = 5.
    IF sy-subrc &lt;&gt; 0.
    ENDIF.

    PERFORM set_layout1.
    PERFORM set_fcat1.
    PERFORM set_handler1.

    CALL METHOD go_alv1-&gt;set_table_for_first_display
      EXPORTING
        i_structure_name              = 'ZSBMM0021'
        is_layout                     = gs_layout1
      CHANGING
        it_outtab                     = gt_ztbmm0021
        it_fieldcatalog               = gt_fcat1
      EXCEPTIONS
        invalid_parameter_combination = 1
        program_error                 = 2
        too_many_lines                = 3
        OTHERS                        = 4.
    IF sy-subrc &lt;&gt; 0.
    ENDIF.

  ELSE.

    CALL METHOD go_alv1-&gt;refresh_table_display
      EXCEPTIONS
        finished = 1
        OTHERS   = 2.
    IF sy-subrc &lt;&gt; 0.
    ENDIF.
  ENDIF.

ENDMODULE.
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
<font color ="#0000FF">*& Module SET_ALV2 OUTPUT</font>
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
<font color ="#0000FF">*&</font>
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
MODULE set_alv2 OUTPUT.

  IF go_cont2 IS INITIAL.
    CREATE OBJECT go_cont2
      EXPORTING
        container_name              = 'AREA2'
      EXCEPTIONS
        cntl_error                  = 1
        cntl_system_error           = 2
        create_error                = 3
        lifetime_error              = 4
        lifetime_dynpro_dynpro_link = 5
        OTHERS                      = 6.
    IF sy-subrc &lt;&gt; 0.
    ENDIF.

    CREATE OBJECT go_alv2
      EXPORTING
        i_parent          = go_cont2
      EXCEPTIONS
        error_cntl_create = 1
        error_cntl_init   = 2
        error_cntl_link   = 3
        error_dp_create   = 4
        OTHERS            = 5.
    IF sy-subrc &lt;&gt; 0.
    ENDIF.

    PERFORM set_layout2.
    PERFORM set_fcat2.
    PERFORM set_handler2.

    CALL METHOD go_alv2-&gt;set_table_for_first_display
      EXPORTING
        i_structure_name              = 'ZSBMM0061'
        is_layout                     = gs_layout2
      CHANGING
        it_outtab                     = gt_ztbmm0061
        it_fieldcatalog               = gt_fcat2
      EXCEPTIONS
        invalid_parameter_combination = 1
        program_error                 = 2
        too_many_lines                = 3
        OTHERS                        = 4.
    IF sy-subrc &lt;&gt; 0.
    ENDIF.

  ELSE.

    CALL METHOD go_alv2-&gt;refresh_table_display
      EXCEPTIONS
        finished = 1
        OTHERS   = 2.
    IF sy-subrc &lt;&gt; 0.
    ENDIF.
  ENDIF.

ENDMODULE.
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
<font color ="#0000FF">*& Module STATUS_0110 OUTPUT</font>
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
<font color ="#0000FF">*&</font>
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
MODULE status_0110 OUTPUT.
  SET PF-STATUS 'S110'.
  SET TITLEBAR 'T110'.
ENDMODULE.

<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
<font color ="#0000FF">*& Module SET_ALV3 OUTPUT</font>
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
<font color ="#0000FF">*&</font>
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
MODULE set_alv3 OUTPUT.

  IF go_cont3 IS INITIAL.
    CREATE OBJECT go_cont3
      EXPORTING
        container_name              = 'AREA3'
      EXCEPTIONS
        cntl_error                  = 1
        cntl_system_error           = 2
        create_error                = 3
        lifetime_error              = 4
        lifetime_dynpro_dynpro_link = 5
        OTHERS                      = 6.
    IF sy-subrc &lt;&gt; 0.
    ENDIF.

    CREATE OBJECT go_alv3
      EXPORTING
        i_parent          = go_cont3
      EXCEPTIONS
        error_cntl_create = 1
        error_cntl_init   = 2
        error_cntl_link   = 3
        error_dp_create   = 4
        OTHERS            = 5.
    IF sy-subrc &lt;&gt; 0.
    ENDIF.

    PERFORM set_layout3.
    PERFORM set_fcat3.

    CALL METHOD go_alv3-&gt;set_table_for_first_display
      EXPORTING
        i_structure_name              = 'ZSBMM0022'
        is_layout                     = gs_layout3
      CHANGING
        it_outtab                     = gt_ztbmm0022
        it_fieldcatalog               = gt_fcat3
      EXCEPTIONS
        invalid_parameter_combination = 1
        program_error                 = 2
        too_many_lines                = 3
        OTHERS                        = 4.
    IF sy-subrc &lt;&gt; 0.
    ENDIF.

  ELSE.

    CALL METHOD go_alv3-&gt;refresh_table_display
      EXCEPTIONS
        finished = 1
        OTHERS   = 2.
    IF sy-subrc &lt;&gt; 0.
    ENDIF.
  ENDIF.

ENDMODULE.
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
<font color ="#0000FF">*& Module STATUS_0120 OUTPUT</font>
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
<font color ="#0000FF">*&</font>
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
MODULE status_0120 OUTPUT.
  SET PF-STATUS 'S120'.
  SET TITLEBAR 'T120'.
ENDMODULE.
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
<font color ="#0000FF">*& Module SET_ALV4 OUTPUT</font>
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
<font color ="#0000FF">*&</font>
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
MODULE set_alv4 OUTPUT.

  IF go_cont4 IS INITIAL.
    CREATE OBJECT go_cont4
      EXPORTING
        container_name              = 'AREA4'
      EXCEPTIONS
        cntl_error                  = 1
        cntl_system_error           = 2
        create_error                = 3
        lifetime_error              = 4
        lifetime_dynpro_dynpro_link = 5
        OTHERS                      = 6.
    IF sy-subrc &lt;&gt; 0.
    ENDIF.

    CREATE OBJECT go_alv4
      EXPORTING
        i_parent          = go_cont4
      EXCEPTIONS
        error_cntl_create = 1
        error_cntl_init   = 2
        error_cntl_link   = 3
        error_dp_create   = 4
        OTHERS            = 5.
    IF sy-subrc &lt;&gt; 0.
    ENDIF.

    PERFORM set_layout4.
    PERFORM set_fcat4.

    CALL METHOD go_alv4-&gt;set_table_for_first_display
      EXPORTING
        i_structure_name              = 'ZSBMM0062'
        is_layout                     = gs_layout4
      CHANGING
        it_outtab                     = gt_ztbmm0062
        it_fieldcatalog               = gt_fcat4
      EXCEPTIONS
        invalid_parameter_combination = 1
        program_error                 = 2
        too_many_lines                = 3
        OTHERS                        = 4.
    IF sy-subrc &lt;&gt; 0.
    ENDIF.

  ELSE.

    CALL METHOD go_alv4-&gt;refresh_table_display
      EXCEPTIONS
        finished = 1
        OTHERS   = 2.
    IF sy-subrc &lt;&gt; 0.
    ENDIF.
  ENDIF.

ENDMODULE.
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
<font color ="#0000FF">*& Module STATUS_0130 OUTPUT</font>
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
<font color ="#0000FF">*&</font>
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
MODULE status_0130 OUTPUT.
  SET PF-STATUS 'S130'.
  SET TITLEBAR 'T130'.
ENDMODULE.
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
<font color ="#0000FF">*& Module SET_ALV5 OUTPUT</font>
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
<font color ="#0000FF">*&</font>
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
MODULE set_alv5 OUTPUT.

  IF go_cont5 IS INITIAL.
    CREATE OBJECT go_cont5
      EXPORTING
        container_name              = 'AREA5'
      EXCEPTIONS
        cntl_error                  = 1
        cntl_system_error           = 2
        create_error                = 3
        lifetime_error              = 4
        lifetime_dynpro_dynpro_link = 5
        OTHERS                      = 6.
    IF sy-subrc &lt;&gt; 0.
    ENDIF.

    CREATE OBJECT go_alv5
      EXPORTING
        i_parent          = go_cont5
      EXCEPTIONS
        error_cntl_create = 1
        error_cntl_init   = 2
        error_cntl_link   = 3
        error_dp_create   = 4
        OTHERS            = 5.
    IF sy-subrc &lt;&gt; 0.
    ENDIF.

    PERFORM set_layout4.
    PERFORM set_fcat5.
    PERFORM set_handler5.

    CALL METHOD go_alv5-&gt;set_table_for_first_display
      EXPORTING
        i_structure_name              = 'ZSBMM0062'
        is_layout                     = gs_layout4
      CHANGING
        it_outtab                     = gt_ztbmm0063
        it_fieldcatalog               = gt_fcat5
      EXCEPTIONS
        invalid_parameter_combination = 1
        program_error                 = 2
        too_many_lines                = 3
        OTHERS                        = 4.
    IF sy-subrc &lt;&gt; 0.
    ENDIF.

  ELSE.

    CALL METHOD go_alv5-&gt;refresh_table_display
      EXCEPTIONS
        finished = 1
        OTHERS   = 2.
    IF sy-subrc &lt;&gt; 0.
    ENDIF.
  ENDIF.

ENDMODULE.
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
<font color ="#0000FF">*& Module GET_HEADER_DATA OUTPUT</font>
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
<font color ="#0000FF">*&</font>
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
MODULE get_header_data OUTPUT.
<font color ="#0000FF">*ALV1의 데이터 MOVE CORRESPONDING + ZTERM 가져와서 OUTPUT FIELD 채우기</font>
  READ TABLE gt_ztbmm0021 INTO zsbmm0021 INDEX gs_row-index.
  MOVE-CORRESPONDING zsbmm0021 TO zsbmm0061.
  PERFORM get_zterm.

ENDMODULE.
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
<font color ="#0000FF">*& Module GET_ITEM_DATA OUTPUT</font>
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
<font color ="#0000FF">*&</font>
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
MODULE get_item_data OUTPUT.
  DATA: ls_ztbmm0021 TYPE ztbmm0021, "구매오더 아이템 str
        lt_ztbmm0021 LIKE TABLE OF ls_ztbmm0021. "구매오더 아이템 itab

  SELECT * "선택된 구매오더의 아이템 데이터를 itab에 담기
    FROM ztbmm0021
    INTO TABLE lt_ztbmm0021
    WHERE ponum = zsbmm0061-ponum.


  LOOP AT lt_ztbmm0021 INTO ls_ztbmm0021.

    zsbmm0062-matcode = ls_ztbmm0021-matcode.
    zsbmm0062-inboquant = ls_ztbmm0021-poquant.
    zsbmm0062-unitcode = ls_ztbmm0021-unitcode.
    zsbmm0062-invoprice = ls_ztbmm0021-poprice.
    zsbmm0062-currency = ls_ztbmm0021-currency.
    APPEND zsbmm0062 TO gt_ztbmm0063.
  endloop.
PERFORM get_matname2. "자재 이름 불러오기

CLEAR zsbmm0062.
ENDMODULE.
</pre>
<hr>
<font size="2" face = "Sans Serif">Extracted by Direct Download Enterprise version 1.3.1 - E.G.Mellodew. 1998-2005 UK. Sap Release 754
</font>
</body>
</html>
